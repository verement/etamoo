<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>MOO.Connection</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_MOO-Connection.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/MOO-Connection.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">etamoo</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">MOO.Connection</p></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">data</span>  <a href="#t:Connection">Connection</a> </li><li class="src short"><span class="keyword">type</span> <a href="#t:ConnectionHandler">ConnectionHandler</a> = ConnectionName -&gt; (Producer <a href="http://hackage.haskell.org/packages/archive/bytestring/latest/doc/html/Data-ByteString.html#t:ByteString">ByteString</a> <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/System-IO.html#t:IO">IO</a> (), Consumer <a href="http://hackage.haskell.org/packages/archive/bytestring/latest/doc/html/Data-ByteString.html#t:ByteString">ByteString</a> <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/System-IO.html#t:IO">IO</a> ()) -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/System-IO.html#t:IO">IO</a> ()</li><li class="src short"><a href="#v:connectionHandler">connectionHandler</a> :: <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-Conc.html#t:TVar">TVar</a> <a href="MOO-Task.html#t:World">World</a> -&gt; <a href="MOO-Types.html#t:ObjId">ObjId</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="MOO-Connection.html#t:ConnectionHandler">ConnectionHandler</a></li><li class="src short"><a href="#v:firstConnectionId">firstConnectionId</a> :: <a href="MOO-Types.html#t:ObjId">ObjId</a></li><li class="src short"><a href="#v:withConnections">withConnections</a> ::  (<a href="http://hackage.haskell.org/packages/archive/containers/latest/doc/html/Data-Map-Lazy.html#t:Map">Map</a> <a href="MOO-Types.html#t:ObjId">ObjId</a> <a href="MOO-Connection.html#t:Connection">Connection</a> -&gt; <a href="MOO-Task.html#t:MOO">MOO</a> a) -&gt; <a href="MOO-Task.html#t:MOO">MOO</a> a</li><li class="src short"><a href="#v:withConnection">withConnection</a> ::  <a href="MOO-Types.html#t:ObjId">ObjId</a> -&gt; (<a href="MOO-Connection.html#t:Connection">Connection</a> -&gt; <a href="MOO-Task.html#t:MOO">MOO</a> a) -&gt; <a href="MOO-Task.html#t:MOO">MOO</a> a</li><li class="src short"><a href="#v:withMaybeConnection">withMaybeConnection</a> ::  <a href="MOO-Types.html#t:ObjId">ObjId</a> -&gt; (<a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> <a href="MOO-Connection.html#t:Connection">Connection</a> -&gt; <a href="MOO-Task.html#t:MOO">MOO</a> a) -&gt; <a href="MOO-Task.html#t:MOO">MOO</a> a</li><li class="src short"><a href="#v:connectionName">connectionName</a> :: <a href="MOO-Connection.html#t:Connection">Connection</a> -&gt; ConnectionName</li><li class="src short"><a href="#v:connectionConnectedTime">connectionConnectedTime</a> :: <a href="MOO-Connection.html#t:Connection">Connection</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-Conc.html#t:TVar">TVar</a> (<a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> <a href="http://hackage.haskell.org/packages/archive/time/latest/doc/html/Data-Time-Clock.html#t:UTCTime">UTCTime</a>)</li><li class="src short"><a href="#v:connectionActivityTime">connectionActivityTime</a> :: <a href="MOO-Connection.html#t:Connection">Connection</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-Conc.html#t:TVar">TVar</a> <a href="http://hackage.haskell.org/packages/archive/time/latest/doc/html/Data-Time-Clock.html#t:UTCTime">UTCTime</a></li><li class="src short"><a href="#v:connectionOutputDelimiters">connectionOutputDelimiters</a> :: <a href="MOO-Connection.html#t:Connection">Connection</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-Conc.html#t:TVar">TVar</a> (Text, Text)</li><li class="src short"><a href="#v:sendToConnection">sendToConnection</a> :: <a href="MOO-Connection.html#t:Connection">Connection</a> -&gt; Text -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-Conc.html#t:STM">STM</a> ()</li><li class="src short"><a href="#v:closeConnection">closeConnection</a> :: <a href="MOO-Connection.html#t:Connection">Connection</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-Conc.html#t:STM">STM</a> ()</li><li class="src short"><a href="#v:notify">notify</a> :: <a href="MOO-Types.html#t:ObjId">ObjId</a> -&gt; <a href="MOO-Types.html#t:StrT">StrT</a> -&gt; <a href="MOO-Task.html#t:MOO">MOO</a> <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:notify-39-">notify'</a> :: <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="MOO-Types.html#t:ObjId">ObjId</a> -&gt; <a href="MOO-Types.html#t:StrT">StrT</a> -&gt; <a href="MOO-Task.html#t:MOO">MOO</a> <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:bufferedOutputLength">bufferedOutputLength</a> :: <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> <a href="MOO-Connection.html#t:Connection">Connection</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-Conc.html#t:STM">STM</a> <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int">Int</a></li><li class="src short"><a href="#v:forceInput">forceInput</a> :: <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="MOO-Types.html#t:ObjId">ObjId</a> -&gt; <a href="MOO-Types.html#t:StrT">StrT</a> -&gt; <a href="MOO-Task.html#t:MOO">MOO</a> ()</li><li class="src short"><a href="#v:flushInput">flushInput</a> :: <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="MOO-Connection.html#t:Connection">Connection</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-Conc.html#t:STM">STM</a> ()</li><li class="src short"><a href="#v:bootPlayer">bootPlayer</a> :: <a href="MOO-Types.html#t:ObjId">ObjId</a> -&gt; <a href="MOO-Task.html#t:MOO">MOO</a> ()</li><li class="src short"><a href="#v:bootPlayer-39-">bootPlayer'</a> :: <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="MOO-Types.html#t:ObjId">ObjId</a> -&gt; <a href="MOO-Task.html#t:MOO">MOO</a> ()</li><li class="src short"><a href="#v:setConnectionOption">setConnectionOption</a> :: <a href="MOO-Types.html#t:ObjId">ObjId</a> -&gt; <a href="MOO-Types.html#t:Id">Id</a> -&gt; <a href="MOO-Types.html#t:Value">Value</a> -&gt; <a href="MOO-Task.html#t:MOO">MOO</a> ()</li><li class="src short"><a href="#v:getConnectionOptions">getConnectionOptions</a> :: <a href="MOO-Types.html#t:ObjId">ObjId</a> -&gt; <a href="MOO-Task.html#t:MOO">MOO</a> (<a href="http://hackage.haskell.org/packages/archive/containers/latest/doc/html/Data-Map-Lazy.html#t:Map">Map</a> <a href="MOO-Types.html#t:Id">Id</a> <a href="MOO-Types.html#t:Value">Value</a>)</li></ul></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:Connection" class="def">Connection</a>  <a href="src/MOO-Connection.html#Connection" class="link">Source</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:ConnectionHandler" class="def">ConnectionHandler</a> = ConnectionName -&gt; (Producer <a href="http://hackage.haskell.org/packages/archive/bytestring/latest/doc/html/Data-ByteString.html#t:ByteString">ByteString</a> <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/System-IO.html#t:IO">IO</a> (), Consumer <a href="http://hackage.haskell.org/packages/archive/bytestring/latest/doc/html/Data-ByteString.html#t:ByteString">ByteString</a> <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/System-IO.html#t:IO">IO</a> ()) -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/System-IO.html#t:IO">IO</a> ()<a href="src/MOO-Connection.html#ConnectionHandler" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:connectionHandler" class="def">connectionHandler</a> :: <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-Conc.html#t:TVar">TVar</a> <a href="MOO-Task.html#t:World">World</a> -&gt; <a href="MOO-Types.html#t:ObjId">ObjId</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="MOO-Connection.html#t:ConnectionHandler">ConnectionHandler</a><a href="src/MOO-Connection.html#connectionHandler" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:firstConnectionId" class="def">firstConnectionId</a> :: <a href="MOO-Types.html#t:ObjId">ObjId</a><a href="src/MOO-Connection.html#firstConnectionId" class="link">Source</a></p><div class="doc"><p>The first un-logged-in connection ID. Avoid conflicts with #-1
 ($nothing), <a name="-2 ($ambiguous_match), and "></a>-3 ($failed_match).
</p></div></div><div class="top"><p class="src"><a name="v:withConnections" class="def">withConnections</a> ::  (<a href="http://hackage.haskell.org/packages/archive/containers/latest/doc/html/Data-Map-Lazy.html#t:Map">Map</a> <a href="MOO-Types.html#t:ObjId">ObjId</a> <a href="MOO-Connection.html#t:Connection">Connection</a> -&gt; <a href="MOO-Task.html#t:MOO">MOO</a> a) -&gt; <a href="MOO-Task.html#t:MOO">MOO</a> a<a href="src/MOO-Connection.html#withConnections" class="link">Source</a></p><div class="doc"><p>Do something with the <code><a href="http://hackage.haskell.org/packages/archive/containers/latest/doc/html/Data-Map-Lazy.html#t:Map">Map</a></code> of all active connections.
</p></div></div><div class="top"><p class="src"><a name="v:withConnection" class="def">withConnection</a> ::  <a href="MOO-Types.html#t:ObjId">ObjId</a> -&gt; (<a href="MOO-Connection.html#t:Connection">Connection</a> -&gt; <a href="MOO-Task.html#t:MOO">MOO</a> a) -&gt; <a href="MOO-Task.html#t:MOO">MOO</a> a<a href="src/MOO-Connection.html#withConnection" class="link">Source</a></p><div class="doc"><p>Do something with the connection for the given object, raising <code><a href="MOO-Types.html#v:E_INVARG">E_INVARG</a></code>
 if no such connection exists.
</p></div></div><div class="top"><p class="src"><a name="v:withMaybeConnection" class="def">withMaybeConnection</a> ::  <a href="MOO-Types.html#t:ObjId">ObjId</a> -&gt; (<a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> <a href="MOO-Connection.html#t:Connection">Connection</a> -&gt; <a href="MOO-Task.html#t:MOO">MOO</a> a) -&gt; <a href="MOO-Task.html#t:MOO">MOO</a> a<a href="src/MOO-Connection.html#withMaybeConnection" class="link">Source</a></p><div class="doc"><p>Do something with the connection for given object, if any.
</p></div></div><div class="top"><p class="src"><a name="v:connectionName" class="def">connectionName</a> :: <a href="MOO-Connection.html#t:Connection">Connection</a> -&gt; ConnectionName<a href="src/MOO-Connection.html#connectionName" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:connectionConnectedTime" class="def">connectionConnectedTime</a> :: <a href="MOO-Connection.html#t:Connection">Connection</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-Conc.html#t:TVar">TVar</a> (<a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> <a href="http://hackage.haskell.org/packages/archive/time/latest/doc/html/Data-Time-Clock.html#t:UTCTime">UTCTime</a>)<a href="src/MOO-Connection.html#connectionConnectedTime" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:connectionActivityTime" class="def">connectionActivityTime</a> :: <a href="MOO-Connection.html#t:Connection">Connection</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-Conc.html#t:TVar">TVar</a> <a href="http://hackage.haskell.org/packages/archive/time/latest/doc/html/Data-Time-Clock.html#t:UTCTime">UTCTime</a><a href="src/MOO-Connection.html#connectionActivityTime" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:connectionOutputDelimiters" class="def">connectionOutputDelimiters</a> :: <a href="MOO-Connection.html#t:Connection">Connection</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-Conc.html#t:TVar">TVar</a> (Text, Text)<a href="src/MOO-Connection.html#connectionOutputDelimiters" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:sendToConnection" class="def">sendToConnection</a> :: <a href="MOO-Connection.html#t:Connection">Connection</a> -&gt; Text -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-Conc.html#t:STM">STM</a> ()<a href="src/MOO-Connection.html#sendToConnection" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:closeConnection" class="def">closeConnection</a> :: <a href="MOO-Connection.html#t:Connection">Connection</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-Conc.html#t:STM">STM</a> ()<a href="src/MOO-Connection.html#closeConnection" class="link">Source</a></p><div class="doc"><p>Initiate the closing of a connection by closing its output queue.
</p></div></div><div class="top"><p class="src"><a name="v:notify" class="def">notify</a> :: <a href="MOO-Types.html#t:ObjId">ObjId</a> -&gt; <a href="MOO-Types.html#t:StrT">StrT</a> -&gt; <a href="MOO-Task.html#t:MOO">MOO</a> <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Bool.html#t:Bool">Bool</a><a href="src/MOO-Connection.html#notify" class="link">Source</a></p><div class="doc"><p>Send data to a connection, flushing if necessary.
</p></div></div><div class="top"><p class="src"><a name="v:notify-39-" class="def">notify'</a> :: <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="MOO-Types.html#t:ObjId">ObjId</a> -&gt; <a href="MOO-Types.html#t:StrT">StrT</a> -&gt; <a href="MOO-Task.html#t:MOO">MOO</a> <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Bool.html#t:Bool">Bool</a><a href="src/MOO-Connection.html#notify%27" class="link">Source</a></p><div class="doc"><p>Send data to a connection, optionally without flushing.
</p></div></div><div class="top"><p class="src"><a name="v:bufferedOutputLength" class="def">bufferedOutputLength</a> :: <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> <a href="MOO-Connection.html#t:Connection">Connection</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-Conc.html#t:STM">STM</a> <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int">Int</a><a href="src/MOO-Connection.html#bufferedOutputLength" class="link">Source</a></p><div class="doc"><p>Return the number of items currently buffered for output to a connection,
 or the maximum number of items that will be buffered up for output on any
 connection.
</p></div></div><div class="top"><p class="src"><a name="v:forceInput" class="def">forceInput</a> :: <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="MOO-Types.html#t:ObjId">ObjId</a> -&gt; <a href="MOO-Types.html#t:StrT">StrT</a> -&gt; <a href="MOO-Task.html#t:MOO">MOO</a> ()<a href="src/MOO-Connection.html#forceInput" class="link">Source</a></p><div class="doc"><p>Force a line of input for a connection.
</p></div></div><div class="top"><p class="src"><a name="v:flushInput" class="def">flushInput</a> :: <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="MOO-Connection.html#t:Connection">Connection</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-Conc.html#t:STM">STM</a> ()<a href="src/MOO-Connection.html#flushInput" class="link">Source</a></p><div class="doc"><p>Flush a connection's input queue, optionally showing what was flushed.
</p></div></div><div class="top"><p class="src"><a name="v:bootPlayer" class="def">bootPlayer</a> :: <a href="MOO-Types.html#t:ObjId">ObjId</a> -&gt; <a href="MOO-Task.html#t:MOO">MOO</a> ()<a href="src/MOO-Connection.html#bootPlayer" class="link">Source</a></p><div class="doc"><p>Close the connection associated with an object.
</p></div></div><div class="top"><p class="src"><a name="v:bootPlayer-39-" class="def">bootPlayer'</a> :: <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="MOO-Types.html#t:ObjId">ObjId</a> -&gt; <a href="MOO-Task.html#t:MOO">MOO</a> ()<a href="src/MOO-Connection.html#bootPlayer%27" class="link">Source</a></p><div class="doc"><p>Close the connection associated with an object, with message varying on
 whether the object is being recycled.
</p></div></div><div class="top"><p class="src"><a name="v:setConnectionOption" class="def">setConnectionOption</a> :: <a href="MOO-Types.html#t:ObjId">ObjId</a> -&gt; <a href="MOO-Types.html#t:Id">Id</a> -&gt; <a href="MOO-Types.html#t:Value">Value</a> -&gt; <a href="MOO-Task.html#t:MOO">MOO</a> ()<a href="src/MOO-Connection.html#setConnectionOption" class="link">Source</a></p><div class="doc"><p>Set a connection option for an active connection.
</p></div></div><div class="top"><p class="src"><a name="v:getConnectionOptions" class="def">getConnectionOptions</a> :: <a href="MOO-Types.html#t:ObjId">ObjId</a> -&gt; <a href="MOO-Task.html#t:MOO">MOO</a> (<a href="http://hackage.haskell.org/packages/archive/containers/latest/doc/html/Data-Map-Lazy.html#t:Map">Map</a> <a href="MOO-Types.html#t:Id">Id</a> <a href="MOO-Types.html#t:Value">Value</a>)<a href="src/MOO-Connection.html#getConnectionOptions" class="link">Source</a></p><div class="doc"><p>Return a <code><a href="http://hackage.haskell.org/packages/archive/containers/latest/doc/html/Data-Map-Lazy.html#t:Map">Map</a></code> of all currently set connection options for a connection.
</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.13.2.1</p></div></body></html>